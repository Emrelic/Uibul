<Window x:Class="UIElementInspector.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:UIElementInspector"
        mc:Ignorable="d"
        Title="Universal UI Element Inspector"
        Height="800" Width="1400"
        WindowStartupLocation="CenterScreen">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="25"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="_File">
                <MenuItem Header="_New Session" Click="NewSession_Click"/>
                <Separator/>
                <MenuItem Header="_Export">
                    <MenuItem Header="Export as _CSV" Click="ExportCSV_Click"/>
                    <MenuItem Header="Export as _TXT" Click="ExportTXT_Click"/>
                    <MenuItem Header="Export as _JSON" Click="ExportJSON_Click"/>
                    <MenuItem Header="Export as _XML" Click="ExportXML_Click"/>
                    <MenuItem Header="Export as _HTML" Click="ExportHTML_Click"/>
                </MenuItem>
                <MenuItem Header="_Import Session" Click="ImportSession_Click"/>
                <Separator/>
                <MenuItem Header="E_xit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Copy Element Data" Click="CopyElementData_Click" InputGestureText="Ctrl+C"/>
                <MenuItem Header="Copy _All Elements" Click="CopyAllElements_Click" InputGestureText="Ctrl+Shift+C"/>
                <MenuItem Header="Copy _Screenshot" Click="CopyScreenshot_Click"/>
                <MenuItem Header="Copy Source _Code" Click="CopySourceCode_Click"/>
                <Separator/>
                <MenuItem Header="_Clear All" Click="ClearAll_Click"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="_Raw View" IsCheckable="True" IsChecked="True" Click="RawView_Click"/>
                <MenuItem Header="_Tree View" IsCheckable="True" Click="TreeView_Click"/>
                <Separator/>
                <MenuItem Header="Show _Properties Panel" IsCheckable="True" IsChecked="True"/>
                <MenuItem Header="Show _Console" IsCheckable="True" IsChecked="True"/>
            </MenuItem>
            <MenuItem Header="_Tools">
                <MenuItem Header="_Screenshot Tool" Click="ScreenshotTool_Click"/>
                <MenuItem Header="_Region Selector" Click="RegionSelector_Click"/>
                <MenuItem Header="_Color Picker" Click="ColorPicker_Click"/>
                <Separator/>
                <MenuItem Header="_Settings" Click="Settings_Click"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_Documentation" Click="Documentation_Click"/>
                <MenuItem Header="_Keyboard Shortcuts" Click="KeyboardShortcuts_Click"/>
                <Separator/>
                <MenuItem Header="_About" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar Grid.Row="1">
            <Button Name="btnStartInspection" Click="StartInspection_Click" ToolTip="Start Inspection (Window will minimize)">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🔍" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Start" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button Name="btnStartKeepVisible" Click="StartKeepVisible_Click" ToolTip="Start Inspection (Window stays visible)" Background="#228B22" Foreground="White">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🔍" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Start (Keep Visible)" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button Name="btnStopInspection" Click="StopInspection_Click" IsEnabled="False" ToolTip="Stop Inspection (F2)">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="⏹" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Stop" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Separator/>

            <!-- Inspection Mode -->
            <TextBlock Text="Mode:" VerticalAlignment="Center" Margin="5,0"/>
            <ComboBox Name="cmbInspectionMode" Width="120" SelectedIndex="0">
                <ComboBoxItem>Hover (Real-time)</ComboBoxItem>
                <ComboBoxItem>Click (Snapshot)</ComboBoxItem>
                <ComboBoxItem>Region Select</ComboBoxItem>
                <ComboBoxItem>Full Window</ComboBoxItem>
            </ComboBox>

            <Separator/>

            <!-- Collection Profile -->
            <TextBlock Text="Profile:" VerticalAlignment="Center" Margin="5,0"/>
            <ComboBox Name="cmbCollectionProfile" Width="100" SelectedIndex="1">
                <ComboBoxItem>Quick</ComboBoxItem>
                <ComboBoxItem>Standard</ComboBoxItem>
                <ComboBoxItem>Full</ComboBoxItem>
                <ComboBoxItem>Custom</ComboBoxItem>
            </ComboBox>

            <Separator/>

            <!-- Detection Technology -->
            <TextBlock Text="Technology:" VerticalAlignment="Center" Margin="5,0"/>
            <ComboBox Name="cmbDetectionTech" Width="130" SelectedIndex="0">
                <ComboBoxItem>Auto Detect</ComboBoxItem>
                <ComboBoxItem>UI Automation</ComboBoxItem>
                <ComboBoxItem>WebView2/CDP</ComboBoxItem>
                <ComboBoxItem>MSHTML</ComboBoxItem>
                <ComboBoxItem>Playwright</ComboBoxItem>
                <ComboBoxItem>All Technologies</ComboBoxItem>
            </ComboBox>

            <Separator/>

            <Button Name="btnRefresh" Click="Refresh_Click" ToolTip="Refresh Current Element (F5)">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🔄" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Refresh" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

            <Button Name="btnScreenshot" Click="Screenshot_Click" ToolTip="Take Screenshot">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="📷" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Screenshot" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

            <Button Name="btnExportQuick" Click="ExportQuick_Click" ToolTip="Quick Export (Ctrl+S)">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="💾" FontSize="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Export" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

            <Separator/>

            <CheckBox Name="chkTopmost" Click="Topmost_Click" VerticalAlignment="Center" Margin="5,0" ToolTip="Keep window always on top">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="📌" FontSize="14" Margin="0,0,3,0"/>
                    <TextBlock Text="Always On Top" VerticalAlignment="Center"/>
                </StackPanel>
            </CheckBox>
        </ToolBar>

        <!-- Main Content -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="400"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Element Tree -->
            <Border Grid.Column="0" BorderBrush="Gray" BorderThickness="1" Margin="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Tree Header -->
                    <Grid Grid.Row="0" Background="LightGray">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Element Hierarchy" VerticalAlignment="Center" Margin="5" FontWeight="Bold"/>
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Button Content="Expand All" Click="ExpandAll_Click" Margin="2" Padding="5,2"/>
                            <Button Content="Collapse All" Click="CollapseAll_Click" Margin="2" Padding="5,2"/>
                        </StackPanel>
                    </Grid>

                    <!-- Tree View -->
                    <TreeView Name="tvElements" Grid.Row="1"
                             SelectedItemChanged="TreeView_SelectedItemChanged"
                             MouseRightButtonUp="TreeView_MouseRightButtonUp">
                        <TreeView.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding ElementType}" FontWeight="Bold" Margin="0,0,5,0"/>
                                    <TextBlock Text="{Binding Name}" FontStyle="Italic"/>
                                    <TextBlock Text=" [" Foreground="Gray"/>
                                    <TextBlock Text="{Binding AutomationId}" Foreground="Gray"/>
                                    <TextBlock Text="]" Foreground="Gray"/>
                                </StackPanel>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>
                    </TreeView>

                    <!-- Search Box -->
                    <Grid Grid.Row="2" Margin="5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Name="txtTreeSearch" Grid.Column="0"
                                TextChanged="TreeSearch_TextChanged"
                                GotFocus="TreeSearch_GotFocus"
                                LostFocus="TreeSearch_LostFocus"
                                Text="Search elements..." Foreground="Gray"/>
                        <Button Grid.Column="1" Content="Search" Click="TreeSearch_Click" Margin="5,0,0,0"/>
                    </Grid>
                </Grid>
            </Border>

            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="Gray"/>

            <!-- Center Panel - Element Details -->
            <Border Grid.Column="2" BorderBrush="Gray" BorderThickness="1" Margin="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Details Header -->
                    <Grid Grid.Row="0" Background="LightGray">
                        <TextBlock Text="Element Properties" VerticalAlignment="Center" Margin="5" FontWeight="Bold"/>
                    </Grid>

                    <!-- Tab Control for Different Views -->
                    <TabControl Grid.Row="1">
                        <!-- Raw Properties Tab -->
                        <TabItem Header="Raw Properties">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBox Name="txtRawProperties"
                                        IsReadOnly="True"
                                        FontFamily="Consolas"
                                        Background="#F5F5F5"
                                        TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </TabItem>

                        <!-- Categorized Properties Tab - ALL 5 TECHNOLOGIES -->
                        <TabItem Header="All Properties (5 Tech)">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <!-- 1. BASIC / UNIVERSAL PROPERTIES -->
                                    <Expander Header="1. BASIC / UNIVERSAL PROPERTIES" IsExpanded="True" Background="#E3F2FD">
                                        <DataGrid Name="dgBasicProperties" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="200">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Expander>

                                    <!-- 2. UI AUTOMATION (UIA) PROPERTIES -->
                                    <Expander Header="2. UI AUTOMATION (UIA) PROPERTIES" Background="#E8F5E9">
                                        <StackPanel>
                                            <!-- UIA Basic -->
                                            <TextBlock Text="Basic UIA Properties" FontWeight="Bold" Margin="5,5,0,2"/>
                                            <DataGrid Name="dgUIABasic" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- UIA Control Patterns -->
                                            <TextBlock Text="Control Patterns" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgUIAPatterns" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- LegacyIAccessible -->
                                            <TextBlock Text="LegacyIAccessible" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgUIALegacy" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="120">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Expander>

                                    <!-- 3. WEBVIEW2 / CDP PROPERTIES -->
                                    <Expander Header="3. WEBVIEW2 / CDP (Chrome DevTools Protocol)" Background="#FFF3E0">
                                        <StackPanel>
                                            <!-- HTML DOM Attributes -->
                                            <TextBlock Text="HTML DOM Attributes" FontWeight="Bold" Margin="5,5,0,2"/>
                                            <DataGrid Name="dgWebDOM" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- ARIA Attributes -->
                                            <TextBlock Text="ARIA Accessibility Attributes" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgWebARIA" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="120">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- Layout / Box Model -->
                                            <TextBlock Text="Layout / Box Model" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgWebLayout" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="120">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- CSS Computed Styles -->
                                            <TextBlock Text="CSS Computed Styles" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgWebCSS" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Expander>

                                    <!-- 4. MSHTML / IHTMLDocument PROPERTIES -->
                                    <Expander Header="4. MSHTML / IHTMLDocument (Trident/IE)" Background="#FCE4EC">
                                        <StackPanel>
                                            <!-- IHTMLElement -->
                                            <TextBlock Text="IHTMLElement Properties" FontWeight="Bold" Margin="5,5,0,2"/>
                                            <DataGrid Name="dgMSHTMLElement" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- IHTMLDocument -->
                                            <TextBlock Text="IHTMLDocument Properties" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgMSHTMLDocument" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="120">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Expander>

                                    <!-- 5. WIN32 API / SPY++ PROPERTIES -->
                                    <Expander Header="5. WIN32 API / SPY++ PROPERTIES" Background="#F3E5F5">
                                        <StackPanel>
                                            <!-- Window Handle Info -->
                                            <TextBlock Text="Window Handle Information" FontWeight="Bold" Margin="5,5,0,2"/>
                                            <DataGrid Name="dgWin32Handle" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="120">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- Window Styles -->
                                            <TextBlock Text="Window Styles (WS_* / WS_EX_*)" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgWin32Styles" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="120">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>

                                            <!-- Window Rectangles -->
                                            <TextBlock Text="Window Rectangles" FontWeight="Bold" Margin="5,10,0,2"/>
                                            <DataGrid Name="dgWin32Rect" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="100">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Expander>

                                    <!-- 6. POSITION & SIZE -->
                                    <Expander Header="6. POSITION &amp; SIZE" Background="#ECEFF1">
                                        <DataGrid Name="dgPosition" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Expander>

                                    <!-- 7. SELECTORS -->
                                    <Expander Header="7. SELECTORS" Background="#E0F7FA">
                                        <StackPanel Margin="10">
                                            <TextBlock Text="XPath:" FontWeight="Bold"/>
                                            <TextBox Name="txtXPath" IsReadOnly="True" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                            <TextBlock Text="Full XPath:" FontWeight="Bold"/>
                                            <TextBox Name="txtFullXPath" IsReadOnly="True" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                            <TextBlock Text="CSS Selector:" FontWeight="Bold"/>
                                            <TextBox Name="txtCssSelector" IsReadOnly="True" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                            <TextBlock Text="Windows Path:" FontWeight="Bold"/>
                                            <TextBox Name="txtWindowsPath" IsReadOnly="True" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                            <TextBlock Text="Playwright Selector:" FontWeight="Bold"/>
                                            <TextBox Name="txtPlaywrightSelector" IsReadOnly="True" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                            <TextBlock Text="Tree Path:" FontWeight="Bold"/>
                                            <TextBox Name="txtTreePath" IsReadOnly="True" TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </Expander>

                                    <!-- 8. HIERARCHY -->
                                    <Expander Header="8. HIERARCHY" Background="#FFF8E1">
                                        <DataGrid Name="dgHierarchy" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Expander>

                                    <!-- 9. TABLE/GRID PROPERTIES -->
                                    <Expander Header="9. TABLE/GRID PROPERTIES" Background="#E8EAF6">
                                        <DataGrid Name="dgTable" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Expander>

                                    <!-- 10. STATE PROPERTIES -->
                                    <Expander Header="10. STATE PROPERTIES" Background="#E0F2F1">
                                        <DataGrid Name="dgState" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Expander>

                                    <!-- 11. CUSTOM PROPERTIES -->
                                    <Expander Header="11. CUSTOM / EXTRA PROPERTIES" Background="#EFEBE9">
                                        <DataGrid Name="dgCustom" AutoGenerateColumns="False" CanUserAddRows="False" MaxHeight="150">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Property" Binding="{Binding Key}" Width="180"/>
                                                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Expander>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>

                        <!-- Source Code Tab -->
                        <TabItem Header="Source Code">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBox Name="txtSourceCode"
                                        IsReadOnly="True"
                                        FontFamily="Consolas"
                                        Background="#F5F5F5"
                                        TextWrapping="NoWrap"
                                        HorizontalScrollBarVisibility="Auto"/>
                            </ScrollViewer>
                        </TabItem>

                        <!-- Screenshot Tab -->
                        <TabItem Header="Screenshot">
                            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                <Image Name="imgScreenshot" Stretch="None"/>
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>
                </Grid>
            </Border>

            <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" Background="Gray"/>

            <!-- Right Panel - Collection Info & Actions -->
            <Border Grid.Column="4" BorderBrush="Gray" BorderThickness="1" Margin="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Info Header -->
                    <Grid Grid.Row="0" Background="LightGray">
                        <TextBlock Text="Collection Information" VerticalAlignment="Center" Margin="5" FontWeight="Bold"/>
                    </Grid>

                    <!-- Current Status -->
                    <GroupBox Grid.Row="1" Header="Current Status" Margin="5">
                        <StackPanel Margin="5">
                            <TextBlock Text="Status:" FontWeight="Bold"/>
                            <TextBlock Name="txtStatus" Text="Ready" Foreground="Green" Margin="0,0,0,5"/>

                            <TextBlock Text="Elements Collected:" FontWeight="Bold"/>
                            <TextBlock Name="txtElementCount" Text="0" Margin="0,0,0,5"/>

                            <TextBlock Text="Collection Time:" FontWeight="Bold"/>
                            <TextBlock Name="txtCollectionTime" Text="0 ms" Margin="0,0,0,5"/>

                            <TextBlock Text="Detection Method:" FontWeight="Bold"/>
                            <TextBlock Name="txtDetectionMethod" Text="None" Margin="0,0,0,5"/>

                            <ProgressBar Name="pbProgress" Height="20" Visibility="Collapsed"/>
                            <TextBlock Name="txtProgress" Text="" HorizontalAlignment="Center" Visibility="Collapsed"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Console Output -->
                    <GroupBox Grid.Row="2" Header="Console Output" Margin="5">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <TextBox Name="txtConsole"
                                    IsReadOnly="True"
                                    FontFamily="Consolas"
                                    Background="Black"
                                    Foreground="LightGreen"
                                    TextWrapping="Wrap"/>
                        </ScrollViewer>
                    </GroupBox>

                    <!-- Quick Actions -->
                    <GroupBox Grid.Row="3" Header="Quick Actions" Margin="5">
                        <StackPanel Margin="5">
                            <Button Content="📋 Copy Full Report (5 Tech)" Click="CopyFullReport_Click" Margin="0,2"
                                    Background="#4CAF50" Foreground="White" FontWeight="Bold"
                                    ToolTip="Copy comprehensive report with ALL properties from all 5 technologies to clipboard"/>
                            <Button Content="Copy Current Element" Click="CopyCurrentElement_Click" Margin="0,2"/>
                            <Button Content="Copy All Elements" Click="CopyAllElementsQuick_Click" Margin="0,2"/>
                            <Button Content="Save Screenshot" Click="SaveScreenshot_Click" Margin="0,2"/>
                            <Button Content="Export to Desktop" Click="ExportToDesktop_Click" Margin="0,2"/>
                            <Button Content="Clear All Data" Click="ClearAllData_Click" Margin="0,2"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock Name="sbStatus" Text="Ready"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Name="sbMousePosition" Text="Mouse: 0, 0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Name="sbElementInfo" Text="No element selected"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock Name="sbMemory" Text="Memory: 0 MB"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
